window.pwhDCFH=window.pwhDCFH||{},function(e){"use strict";const t=pwh_dcfh_obj.i10n,a=".et_pb_contact_form_container",n=".et_pb_contact_form",i=".et_pb_contact_submit",o=".et-pb-contact-message",l=e(`.${pwh_dcfh_obj.datepickerClass}`),s=e(".et_pb_contact_select2"),d=`.${pwh_dcfh_obj.uploadFileClass}`,c=(pwh_dcfh_obj.wpLocale,pwh_dcfh_obj.wpMaxUploadSize,pwh_dcfh_obj.wpMaxUploadSizeFormatted,new Date);pwhDCFH.init=function(){e(n).length>0&&(pwh_dcfh_obj.isSuperAdmin&&e(".et_pb_contact_form_container").length>0&&pwhDCFH.duplicateFormIDWarning(),e(".et_pb_textarea_validation").length>0&&pwhDCFH.textareaValidation(),e(d).length>0&&(pwhDCFH.uploadFiles(),pwhDCFH.removeFile()),l.length>0&&pwhDCFH.addDateTimePicker(),s.length>0&&pwhDCFH.addSelect2(),pwhDCFH.addUniqueViewCookie(),pwhDCFH.showLoadingIcon(),pwhDCFH.redirectForm(),pwhDCFH.addClassToContactMessage(),pwhDCFH.updateETPBCustom())},pwhDCFH.duplicateFormIDWarning=function(){let n=[];if(e(a).length>1){e(a).each((function(t,a){let i=e(this).attr("id"),o=e(this).data("form_unique_id");n[o]?n[o].push(i):n[o]=[i]}));for(let a in n){let i=n[a];i.length>1&&e(i).each((function(a,n){e(`#${n}`).prepend("<div class='et_pb_duplicate_form_id_warning'>"+t.duplicate_form_id_text+"</div>")}))}}},pwhDCFH.addUniqueViewCookie=function(){e(a).each((function(t,a){let n=e(this).data("form_unique_id"),i=e(this).find("form").attr("data-unique-views-cookies");if(void 0!==n&&void 0!==i&&"on"===i){let e="pwh_dcfh_uniqueviews_"+pwh_dcfh_obj.userIpAddress+"_"+n;pwhDCFH.setCookie(e,"pwh_dcfh_unique_views",364)}}))},pwhDCFH.showLoadingIcon=function(){e.fn.fadeToOrig=e.fn.fadeTo,e.fn.fadeTo=function(){const t=e(this),a=".et_pb_contact_form_overlay";return t.find(a).length&&arguments[1]<1&&t.find(a).show(),e.fn.fadeToOrig.apply(this,arguments)}},pwhDCFH.addDateTimePicker=function(){l.each((function(t){let a=e(this).closest("form").parent().parent().attr("id"),n=e(`#${a}`).attr("class");n=n.replace("et_pb_module","").replace("et_pb_contact_form_container","").replace("clearfix","");let i='input[name="'+e(this).attr("name")+'"]',o=e(i).data("config"),l=o.type,s=o.show_inline,d=o.setcurrent_datetime,_=o.rtl,r=o.disabled_weeks,p=o.disabled_week_days,f=o.date_format,u=o.time_format,m=o.min_date_type,h=o.min_date,b=o.max_date_type,v=o.max_date,w=o.available_dates,g=o.unavailable_dates,C=o.min_time,x=o.max_time,D=o.available_times,$=o.available_day_times,y=o.unavailable_times,F=o.unavailable_day_times,k={inline:!1,step:o.time_steps,closeOnDateSelect:!1,dayOfWeekStart:o.week_start,className:n,todayButton:!1,validateOnBlur:!1,scrollMonth:!1,scrollTime:!1,scrollInput:!1};if(k.format="date"===l?f:"time"===l?u:f+" "+u,""!==f?(k.datepicker=!0,k.formatDate=f):k.datepicker=!1,""!==u?(k.timepicker=!0,k.formatTime=u):k.timepicker=!1,void 0!==s&&"on"===s&&(k.inline=!0,k.lazyInit=!0,k.allowBlank=!0),void 0!==d&&"on"===d&&(k.value=c),void 0!==_&&"on"===_&&(k.rtl=!0),"off"===r&&(k.weeks=!0),""!==p&&("string"===jQuery.type(p)?(p=p.split(",").map((function(e){return parseInt(e)})),k.disabledWeekDays=p):k.disabledWeekDays=[p]),void 0!==o.disabled_past_days&&"on"===o.disabled_past_days&&(k.minDate=c),void 0!==m&&("fixed"===m&&(k.minDate=h),"relative"===m&&(k.minDate=h)),void 0!==b&&("fixed"===b&&(k.maxDate=v),"relative"===b&&(k.maxDate=v)),void 0!==w){const e=w.split(",",1).toString();k.startDate=e.replace(/[^\w\s]/gi,""),k.allowDates=w}void 0!==g&&(k.disabledDates=g),void 0!==C&&(k.minTime=C),void 0!==x&&(k.maxTime=x),void 0!==D&&(k.allowTimes=D.split(",")),k.onSelectDate=function(e,t){let a=new Date(e).toLocaleDateString("en",{weekday:"long"}).toLowerCase();if(void 0!==$&&void 0!==$[`available_times_${a}`]&&$[`available_times_${a}`].length>0){let e=$[`available_times_${a}`].split(",");this.setOptions({allowTimes:e})}else this.setOptions({allowTimes:""})},k.onGenerate=function(t,a){let n=new Date(t).toLocaleDateString("en",{weekday:"long"}).toLowerCase();if(e(this).css("left",e(i).offset().left),e(this).css("width","auto"),void 0!==o.disabled_current_date&&"on"===o.disabled_current_date&&e(".xdsoft_today").removeClass("xdsoft_current").addClass("xdsoft_disabled"),void 0!==w&&setTimeout((function(){e.each(w.split(","),(function(t,a){let n=new Date(a);if(void 0!==n){const t=e(`td[data-date="${n.getDate()}"][data-month="${n.getMonth()}"]`);t.hasClass("xdsoft_disabled")&&t.removeClass("xdsoft_disabled")}}))}),100),void 0!==y){let t=y.split(",");e(".xdsoft_time").each((function(a,n){let i=e(this);-1!==e.inArray(i.text(),t)&&i.toggleClass("xdsoft_disabled")}))}if(void 0!==F&&void 0!==F[`unavailable_times_${n}`]&&F[`unavailable_times_${n}`].length>0){let t=F[`unavailable_times_${n}`].split(",");e(".xdsoft_time").each((function(a,n){let i=e(this);-1!==e.inArray(i.text(),t)&&i.toggleClass("xdsoft_disabled")}))}},e(i).datetimepicker(k),e.datetimepicker.setLocale(o.locale)}))},pwhDCFH.addSelect2=function(){s.select2(),e(document).on("select2:open",(t=>{const a=t.target.id;e(".select2-search__field[aria-controls='select2-"+a+"-results']").each((function(e,t){t.focus()}))}))};var _=null,r={},p=[];pwhDCFH.uploadFiles=function(){e(document).on("submit","form.et_pb_contact_form",(function(t){if(t.preventDefault(),null!==_){let t=e(this).parents('div[class*="et_pb_contact_form_container"]'),a=t.find(`${o}.et_pb_contact_message_top`);"none"===a.css("display")&&(a=t.find(`${o}.et_pb_contact_message_bottom`)),a.children().length>0?a.find("ul").first().append(_):a.append(`<ul>${_}</ul>`)}e.each(e(this).find(".et_pb_contact_hidden_files"),(function(t,a){let n=e(this),i=n.data("field-id");n.hasClass("et_contact_error")?void 0!==n.data("required_mark")&&"required"===n.data("required_mark")&&e(`p.et_pb_contact_field.et_pb_contact_field_${i}`).addClass("et_pb_required_border"):n.attr("novalidate")||""!==n.val()||"undefined"===n.data("required_mark")||"required"!==n.data("required_mark")?e(`p.et_pb_contact_field.et_pb_contact_field_${i}`).removeClass("et_pb_required_border"):e(`p.et_pb_contact_field.et_pb_contact_field_${i}`).addClass("et_pb_required_border")}))})),e("body").on("click",".et_pb_file_upload_button",(function(t){t.preventDefault(),e(this).parent().find(d).trigger("click")})),e("body").on("change",d,(function(){let a=new FormData,n=!1,l="",s=e(this),d=s.parent(),c=s.closest("form"),f=(c.parents('div[class^="et_pb_contact"]'),c.find(i).text()),u=c.find(i).data("wait-text"),m=s.data("field-id"),h=s.prop("files"),b=s.attr("name"),v=s.data("limit"),w=s.data("size"),g=s.data("size-formatted"),C=s[0].hasAttribute("multiple"),x=`input:file[name=${b}]`,D=`input:text[name=${b}]`,$=`input:hidden[name=${b}_file_token]`,y=e(`#et_pb_accepted_files_desc_${m}`),F=s.parents('div[class*="et_pb_contact_form_container"]'),k=F.find(`${o}.et_pb_contact_message_top`);"none"===k.css("display")&&(k=F.find(`${o}.et_pb_contact_message_bottom`));let H=e(`p.et_pb_contact_field.et_pb_contact_field_${m}`);r.hasOwnProperty(m)||(r[m]=[]),C||1!==r[m].length||(l+=`<li>${t.x_files_allow_text.replace("{allowed_files}",1)}</li>`,n=!0),h.length+r[m].length>v&&(l+=`<li>${t.x_files_allow_text.replace("{allowed_files}",v)}</li>`,n=!0);for(let e=0;e<=h.length-1;e++)h[e].size>=w&&(l+=`<li>${t.allow_filesize_text.replace("{filename}",h[e].name).replace("{allowed_filesize}",g)}</li>`,n=!0);if(n&&(_=l,e(x).val(""),e(D).addClass("et_contact_error"),e(D).attr("data-required_mark","required"),k.children().length>0?k.find("ul").first().append(l):k.append(`<ul>${l}</ul>`),H.addClass("et_pb_required_border"),k.addClass("et_pb_contact_error_meesage")),!1===n){for(let e=0;e<=h.length-1;e++){if(p.includes(h[e].name))return l+=`<li>${t.already_attached_text.replace("{filename}",h[e].name)}</li>`,k.children().length>0?k.find("ul").first().append(l):k.append(`<ul>${l}</ul>`),void H.addClass("et_pb_required_border");a.append(e,h[e]),p.push(h[e].name)}a.append("action","upload_file"),a.append("_wpnonce",pwh_dcfh_obj.ajaxNonce),a.append("token",e($).val()),e.ajax({type:"post",dataType:"json",contentType:!1,processData:!1,url:pwh_dcfh_obj.ajaxURL,data:a,xhr:function(){let e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){let a=Math.round(e.loaded/e.total*100);y.html(t.uploading_text.replace("{percentage}",a+"%"))}}),!1),e},beforeSend:function(){k.find('ul li:contains("'+d.find("label.et_pb_contact_form_label").text()+'")').remove(),H.removeClass("et_pb_required_border"),0===k.find("li").length&&k.find("p").remove(),d.find(".et_pb_contact_spinner").addClass("is-active"),e(x).prop("disabled",!0),c.find(i).prop("disabled",!0),c.find(i).text(u)},success:function(a){if(!1!==a.success){if(a.data.success.length>0){let n="";e.each(a.data.success,(function(e,a){n+=`<span class="et_pb_file" data-id="${a.name}">`,n+=`<a href="${a.url}" class="et_pb_file_name" download>${a.tmp_name}</a>`,n+=`<span class="et_pb_file_size">(${a.size})</span>`,n+=`<span class="et-pb-icon et_pb_delete_file" aria-hidden="true" title="${t.delete_file_icon_hover_text}"  data-field-id="${m}" data-field-name="${b}" data-file-name="${a.name}"  data-file-tmp-name="${a.tmp_name}">&#x4d;</span>`,n+="</span>",r.hasOwnProperty(m)||(r[m]=[]),r[m].push(a.name)})),d.find(".et_pb_files_list").append(n),e(D).val(r[m].join())}if(a.data.errors.length>0){n=!0;let t="";e.each(a.data.errors,(function(e,a){t+=`<li>${a.message}</li>`})),k.children().length>0?k.find("ul").first().append(t):k.append(`<ul>${t}</ul>`),k.addClass("et_pb_contact_error_meesage"),H.addClass("et_pb_required_border"),_=t}}else k.append(a.data)},complete:function(){e(x).val(""),y.html(y.data("description")),d.find(".et_pb_contact_spinner").removeClass("is-active"),e(x).prop("disabled",!1),c.find(i).prop("disabled",!1),c.find(i).text(f);let a=e(D).val().split(",").length,o=t.selected_files_text.match(/\{_.+?}/g).map((function(e){return e.slice(1,-1).replaceAll("_","")}));o=o.find((e=>!!e)),!1===n&&(a=1===a?t.selected_files_text.replace("{chosen_files_count}",a).replace(`{_${o}_}`,""):t.selected_files_text.replace("{chosen_files_count}",a).replace(`{_${o}_}`,o),d.find(".et_pb_file_chosen_desc").text(a))},error:function(e,t,a){}})}}))},pwhDCFH.removeFile=function(){e("body").on("click",".et_pb_delete_file",(function(){let a=e(this),n=a.closest("form"),l=n.find(i).text(),s=n.find(i).data("wait-text"),d=a.data("file-tmp-name"),c=a.data("file-name");if(confirm(t.remove_file_text.replace("{filename}",d))){let _=e(o).parent().find(o),f=a.data("field-name"),u=a.data("field-id");if(""!==f&&""!==c){let a=`input:text[name="${f}"]`;e.ajax({type:"post",dataType:"json",url:pwh_dcfh_obj.ajaxURL,data:{action:"remove_file",_wpnonce:pwh_dcfh_obj.ajaxNonce,file_name:c},beforeSend:function(){n.find(".et_pb_contact_spinner").addClass("is-active"),n.find(i).prop("disabled",!0),n.find(i).text(s)},success:function(i){if(!0===i.success){e('span[data-id="'+c+'"]').remove();let i=e(a).val().split(",").filter((function(e){return e!==c}));r[u]=i,e(a).val(i.join(",")),p=p.filter((function(e){return e.replace(/\s+/g,"-")!==d}));let o=i.length;o=0===o?t.chosen_file_text:1===o?t.selected_files_text.replace("{chosen_files_count}",o).replace("{s}",""):t.selected_files_text.replace("{chosen_files_count}",o).replace("{s}","s"),n.find(".et_pb_file_chosen_desc").text(o)}else _.html("<p>"+i.data+"</p>")},complete:function(){n.find(".et_pb_contact_spinner").removeClass("is-active"),n.find(i).prop("disabled",!1),n.find(i).text(l)},error:function(e,t,a){}})}}}))},pwhDCFH.redirectForm=function(){e(document).on("submit","form.et_pb_contact_form",(function(t){var a=e(this),n=a.parents('div[class*="et_pb_contact_form_container"]');if(void 0!==n){let t=e(n).find("form").data("redirect-url"),i=e(n).find("form").data("redirect-delay");if(void 0!==t&&void 0!==i){const e=setInterval((function(){0===a.parents('div[class*="et_pb_contact_form_container"]').find("form").length&&(clearInterval(e),setTimeout((function(){location.href=t}),i))}),1e3)}}}))},pwhDCFH.addClassToContactMessage=function(){e(document).on("submit","form.et_pb_contact_form",(function(t){let a=e(this),n=a.parents(),i=e(n.get(1)).hasClass("et_pb_recaptcha_enabled")||!1,l=a.parents('div[class*="et_pb_contact_form_container"]'),s=l.find(`${o}.et_pb_contact_message_top`);if("none"===s.css("display")&&(s=l.find(`${o}.et_pb_contact_message_bottom`)),!i&&s.children().length>0)s.addClass("et_pb_contact_error_meesage");else if(i){const e=setInterval((function(){s.children().length>0&&(clearInterval(e),s.addClass("et_pb_contact_error_meesage"))}),50)}}))},pwhDCFH.formTextareaCounter=0,pwhDCFH.textareaValidation=function(){e(document).on("submit","form.et_pb_contact_form",(function(t){var a=e(this);pwhDCFH.formTextareaCounter=pwhDCFH.formTextareaCounter+1,a.find(".et_pb_textarea_validation").each((function(t,n){let i=e(this),l=(i.closest("form"),i.data("field-name")),s=e(`#${l}`),d=i.data("title"),c=s.data("pattern"),_=s.data("message"),r=new RegExp("^"+c+"$");const p={};let f=a.parents('div[class*="et_pb_contact_form_container"]'),u=f.find(`${o}.et_pb_contact_message_top`);"none"===u.css("display")&&(u=f.find(`${o}.et_pb_contact_message_bottom`)),u.has("ul").find("li").each((function(t,a){let n=e(this).text().toLowerCase();p[n]?e(this).remove():p[n]=!0})),""!==document.all[l].value&&(e.trim(document.all[l].value).match(r)?(i.val(!0),i.removeClass("et_contact_error"),i.removeAttr("data-required_mark"),u.find('ul li:contains("'+d+'")').remove(),0===u.find("li").length&&u.find("p").remove(),1===pwhDCFH.formTextareaCounter&&a.submit()):(i.val(""),i.addClass("et_contact_error"),i.attr("data-required_mark","required"),u.find('ul li:contains("'+d+'")').html(_)))}))}))},pwhDCFH.updateETPBCustom=function(){if("undefined"!=typeof et_pb_custom){let e=et_pb_custom.fill_message,t=et_pb_custom.contact_error_message;et_pb_custom.fill_message=e.replace(","," "),et_pb_custom.contact_error_message=t.replace(","," ")}},pwhDCFH.synchronizingICSURL=function(){e(document).on("click","button.ics_url_sync_btn",(function(t){t.preventDefault();let a=e(this),n=a.data("wpnonce"),i=e(this).parents('div[class*="et-fb-form__group"]').prev();if(i.length>0){let t=a.text(),o=i.find("input").val();""!==o&&""!==n?e.ajax({type:"post",dataType:"json",url:pwh_dcfh_obj.ajaxURL,data:{action:"sync_ics_url",_wpnonce:n,url:decodeURIComponent(o)},beforeSend:function(){i.prev().prev().find("input").val(""),i.prev().prev().find("input").focus(),i.prev().prev().find("input").click(),a.text("Please wait synchronizing data from url...")},success:function(t){t.success?setTimeout((function(){let a=t.data.dates_str.replace(/,(?=[^,]*$)/,"");i.prev().prev().find("input").val(a),i.prev().prev().find("input").focus(),i.prev().prev().find("input").click(),e(".et-fb-button--publish").click()}),500):alert(t.data)},complete:function(){a.text(t),i.find("input").val("")},error:function(e,t,a){}}):alert("Please add ICS Feed URL.")}}))},pwhDCFH.setCookie=function(e,t,a){let n="";if(a){let e=new Date;e.setTime(e.getTime()+24*a*60*60*1e3),n="; expires="+e.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"},pwhDCFH.messageConatiner=function(t){let a=e(t.parents().get(3)).find(`${o}.et_pb_contact_message_top`);return"none"===a.css("display")&&(a=e(t.parents('div[class^="et_pb_contact"]').next())),a},e(pwhDCFH.init)}(jQuery);
